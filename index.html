<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HobbyNB - Find Activity Partners</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; overflow: hidden; }

        /* --- 1. Map Layer --- */
        #map { width: 100vw; height: 100vh; z-index: 1; }

        /* --- 2. The Static Center Pin (Simplification) --- */
        /* This replaces the need for JS to track the center marker */
        .center-pin {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 500;
            pointer-events: none; /* Let clicks pass through to map */
        }
        .pin-circle {
            width: 20px; height: 20px;
            background: #1e90ff; border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 0 0 10px rgba(30, 144, 255, 0.3);
        }

        /* --- 3. UI Overlay --- */
        .ui-container {
            position: absolute; bottom: 20px; left: 0; right: 0;
            z-index: 999;
            display: flex; justify-content: center;
            pointer-events: none; /* Allow clicking map on sides */
        }
        
        .control-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            padding: 20px;
            width: 90%; max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            pointer-events: auto; /* Re-enable clicking for buttons */
        }

        h2 { margin: 0 0 5px 0; font-size: 1.2rem; color: #333; }
        p { margin: 0 0 15px 0; font-size: 0.85rem; color: #666; }

        /* Grid */
        .hobby-grid { 
            display: grid; grid-template-columns: repeat(3, 1fr); 
            gap: 8px; margin-bottom: 15px; 
        }
        .hobby-btn {
            background: #f1f2f6; border: 1px solid #ddd;
            border-radius: 8px; padding: 10px; font-size: 0.9rem;
            cursor: pointer; transition: 0.2s;
        }
        .hobby-btn.active { 
            background: #2ed573; color: white; border-color: #2ed573; 
        }

        /* Action Button */
        .whatsapp-btn {
            background: #25D366; color: white; border: none;
            padding: 12px 30px; border-radius: 50px;
            font-weight: bold; font-size: 1rem; cursor: pointer;
            width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .whatsapp-btn:hover { background: #20bd5a; }

        /* --- 4. Animation for Decor --- */
        .emoji-float { font-size: 30px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

    </style>
</head>
<body>

    <div class="center-pin">
        <div class="pin-circle"></div>
    </div>

    <div id="map"></div>

    <div class="ui-container">
        <div class="control-panel">
            <h2>Find Hobby Partners</h2>
            <p>1. Drag map to your location<br>2. Pick hobbies & join WhatsApp</p>

            <div class="hobby-grid" id="hobbyGrid"></div>
            
            <button class="whatsapp-btn" onclick="sendToWhatsapp()">
                Join via WhatsApp
            </button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // --- CONFIGURATION ---
        const hobbies = [
            { label: 'Dance', emoji: 'üíÉ' },
            { label: 'Paint', emoji: 'üé®' },
            { label: 'Tennis', emoji: 'üéæ' },
            { label: 'Badminton', emoji: 'üè∏' },
            { label: 'Music', emoji: 'üé∏' },
            { label: 'Chess', emoji: '‚ôüÔ∏è' }
        ];

        let selectedHobbies = [];

        // --- MAP SETUP ---
        // Default View: Chennai
        const map = L.map('map', { zoomControl: false }).setView([13.0827, 80.2707], 13);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap',
            maxZoom: 19
        }).addTo(map);

        // --- DECORATIVE MARKERS (Just for visuals) ---
        const markersLayer = L.layerGroup().addTo(map);

        function addRandomFloaters() {
            markersLayer.clearLayers();
            const bounds = map.getBounds();
            
            // Create 3 random floaters in the current view
            for(let i=0; i<3; i++) {
                const lat = bounds.getSouth() + Math.random() * (bounds.getNorth() - bounds.getSouth());
                const lng = bounds.getWest() + Math.random() * (bounds.getEast() - bounds.getWest());
                const h = hobbies[Math.floor(Math.random() * hobbies.length)];
                
                const icon = L.divIcon({
                    className: '', 
                    html: `<div class="emoji-float">${h.emoji}</div>`,
                    iconSize: [30, 30]
                });
                L.marker([lat, lng], {icon: icon}).addTo(markersLayer);
            }
        }
        
        map.on('moveend', addRandomFloaters);
        addRandomFloaters(); // Init

        // --- UI LOGIC ---
        const grid = document.getElementById('hobbyGrid');
        
        hobbies.forEach(h => {
            const btn = document.createElement('div');
            btn.className = 'hobby-btn';
            btn.innerText = `${h.emoji} ${h.label}`;
            btn.onclick = () => {
                btn.classList.toggle('active');
                if (selectedHobbies.includes(h.label)) {
                    selectedHobbies = selectedHobbies.filter(i => i !== h.label);
                } else {
                    selectedHobbies.push(h.label);
                }
            };
            grid.appendChild(btn);
        });

        // --- WHATSAPP LOGIC ---
        function sendToWhatsapp() {
            if (selectedHobbies.length === 0) {
                alert("Please select at least one hobby!");
                return;
            }

            // Get coordinates from the center of the map view
            const center = map.getCenter(); 
            const lat = center.lat.toFixed(6);
            const lng = center.lng.toFixed(6);
            const mapLink = `https://maps.google.com/?q=${lat},${lng}`;

            // Construct Message
            const text = 
`Hi! I'm interested in joining HobbyNB.

*Hobbies:* ${selectedHobbies.join(', ')}
*My Location:* ${mapLink}`;

            // Open WhatsApp
            const url = `https://wa.me/31682349653?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>


